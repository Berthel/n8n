{
  "createdAt": "2025-10-22T15:50:25.981Z",
  "updatedAt": "2025-10-22T19:35:11.000Z",
  "id": "cItPt9hr0xCLTDxv",
  "name": "RAG Pipeline",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {},
      "id": "76571f65-1267-4237-ae7d-4b42981b55bb",
      "name": "Manual Trigger - Ingestion",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        2368,
        3408
      ],
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "qdrantCollectionName",
              "value": "32fa8820-791a-488d-bb75-1b5ac85c4765",
              "type": "string"
            },
            {
              "id": "id-2",
              "name": "googleDriveFolderId",
              "value": "12U_typ9QZfgkVw8PKsOAFj19OB0Z40IO",
              "type": "string"
            },
            {
              "id": "id-3",
              "name": "qdrantUrl",
              "value": "https://32fa8820-791a-488d-bb75-1b5ac85c4765.eu-central-1-0.aws.cloud.qdrant.io:6333",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "56ed88c5-d079-4192-9350-ceb0d19d8fd8",
      "name": "Workflow Configuration",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2592,
        3408
      ],
      "disabled": true
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "returnAll": true,
        "filter": {
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Workflow Configuration').first().json.googleDriveFolderId }}"
          }
        },
        "options": {}
      },
      "id": "d4244c36-a2f1-4716-8349-5b6bdf9ccb7a",
      "name": "List Files from Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        2816,
        3408
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "UAOjLkQzFGJLtPGd",
          "name": "Google Drive account 3"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json.id }}"
        },
        "options": {
          "fileName": "={{ $json.name }}"
        }
      },
      "id": "a0fd69fc-6dee-44e4-9703-3f3b290496f3",
      "name": "Download File",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        3040,
        3408
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "UAOjLkQzFGJLtPGd",
          "name": "Google Drive account 3"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "id": "ffc53d24-0ea0-4a71-81af-544c36f7f01f",
      "name": "Extract Text from File",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        3264,
        3408
      ],
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst output = [];\n\nfor (const item of items) {\n  const fileName = item.json.fileName || 'unknown';\n  const text = item.json.text || '';\n  const createdAt = new Date().toISOString();\n  \n  output.push({\n    json: {\n      pageContent: text,\n      metadata: {\n        file_name: fileName,\n        language: 'auto',\n        created_at: createdAt,\n        source: 'google_drive'\n      }\n    }\n  });\n}\n\nreturn output;"
      },
      "id": "95d03238-5ab9-425d-8b8e-6f0b911ca9f4",
      "name": "Prepare Document Metadata",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3488,
        3408
      ],
      "disabled": true
    },
    {
      "parameters": {
        "chunkSize": 800,
        "chunkOverlap": 100
      },
      "id": "33d7ab63-446c-47c6-867f-6277d0b6bfdc",
      "name": "Token Splitter (~800 tokens)",
      "type": "@n8n/n8n-nodes-langchain.textSplitterTokenSplitter",
      "typeVersion": 1,
      "position": [
        3920,
        3840
      ],
      "disabled": true
    },
    {
      "parameters": {
        "textSplittingMode": "custom",
        "options": {}
      },
      "id": "aa42fa62-58f1-4f80-9303-b7864e0f2e8e",
      "name": "Document Loader",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        3840,
        3632
      ],
      "disabled": true
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "09a0fc61-5e14-4aba-8b2d-59c14db4981e",
      "name": "OpenAI Embeddings (Dense)",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        3712,
        3632
      ],
      "credentials": {
        "openAiApi": {
          "id": "ZjiR1Y4tdzymEK1L",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "mode": "insert",
        "qdrantCollection": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Workflow Configuration').first().json.qdrantCollectionName }}"
        },
        "options": {}
      },
      "id": "f8a2d7fc-c300-4427-b89a-58d01779591b",
      "name": "Qdrant Vector Store - Insert",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "typeVersion": 1.3,
      "position": [
        3744,
        3408
      ],
      "credentials": {
        "qdrantApi": {
          "id": "O9P2jm3YrDRzEOWf",
          "name": "QdrantApi account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "17ad2e30-f212-4402-9e73-4dd4dc910e86",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        1968,
        4144
      ],
      "webhookId": "5e56a263-3a40-44bd-bc9d-1cfb3bc2a87d",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "You are a helpful assistant. You have access to a tool to retrieve data from a semantic database to answer questions. Always provide arguments when you execute the tool"
        }
      },
      "id": "f5945d04-13cf-49c4-90df-bb232c9134ed",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        3216,
        3984
      ],
      "typeVersion": 2
    },
    {
      "parameters": {},
      "id": "c483bb8a-fc2d-4dc1-ba4c-dfc08b4ce4c6",
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        3264,
        4224
      ],
      "typeVersion": 1.3
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "retriever",
        "toolDescription": "Retrieve data from a semantic database to answer questions",
        "qdrantCollection": {
          "__rl": true,
          "value": "32fa8820-791a-488d-bb75-1b5ac85c4765",
          "mode": "id"
        },
        "useReranker": true,
        "options": {}
      },
      "id": "60e7ead6-f469-40d8-a0b4-81feec72f6ca",
      "name": "Qdrant Vector Store1",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "position": [
        3536,
        4256
      ],
      "typeVersion": 1.2,
      "credentials": {
        "qdrantApi": {
          "id": "O9P2jm3YrDRzEOWf",
          "name": "QdrantApi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        3088,
        4192
      ],
      "id": "fdb433f6-364e-49d4-9672-5b6a73e57326",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "ZjiR1Y4tdzymEK1L",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        3680,
        4464
      ],
      "id": "4cb82412-15ed-4c01-bc64-965ebe6867fc",
      "name": "Reranker Cohere",
      "credentials": {
        "cohereApi": {
          "id": "xxYqDmIsjv9vqLj9",
          "name": "CohereApi account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "f4259089-b410-421b-9b12-e00a4cedbbe6",
      "name": "OpenAI Embeddings (Query)",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        2048,
        4512
      ],
      "credentials": {
        "openAiApi": {
          "id": "ZjiR1Y4tdzymEK1L",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "qdrantCollection": {
          "__rl": true,
          "value": "=32fa8820-791a-488d-bb75-1b5ac85c4765",
          "mode": "id"
        },
        "useReranker": true,
        "options": {}
      },
      "id": "7fde53b1-725c-4e6f-a398-dcd4fbcf971f",
      "name": "Qdrant Vector Store - Retrieve",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "typeVersion": 1.3,
      "position": [
        2256,
        4608
      ],
      "credentials": {
        "qdrantApi": {
          "id": "O9P2jm3YrDRzEOWf",
          "name": "QdrantApi account"
        }
      }
    },
    {
      "parameters": {
        "topN": 15
      },
      "id": "920ed539-4956-41df-8214-652a84af7ab6",
      "name": "Cohere Reranker",
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        2048,
        4688
      ],
      "credentials": {
        "cohereApi": {
          "id": "xxYqDmIsjv9vqLj9",
          "name": "CohereApi account"
        }
      }
    },
    {
      "parameters": {
        "topK": 15
      },
      "id": "39a43eba-44d2-40d0-9bd1-e8dddbf48fa2",
      "name": "Vector Store Retriever",
      "type": "@n8n/n8n-nodes-langchain.retrieverVectorStore",
      "typeVersion": 1,
      "position": [
        2272,
        4416
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "85c64076-f051-4b71-9eb9-67b2da859ae9",
      "name": "Question and Answer Chain",
      "type": "@n8n/n8n-nodes-langchain.chainRetrievalQa",
      "typeVersion": 1.6,
      "position": [
        2384,
        4192
      ]
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "id",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "id": "88da6a3d-74c4-4f0c-8856-43ada8b5b434",
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        2160,
        4352
      ],
      "credentials": {
        "openAiApi": {
          "id": "ZjiR1Y4tdzymEK1L",
          "name": "OpenAi account"
        }
      }
    }
  ],
  "connections": {
    "Manual Trigger - Ingestion": {
      "main": [
        [
          {
            "node": "Workflow Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Workflow Configuration": {
      "main": [
        [
          {
            "node": "List Files from Google Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Files from Google Drive": {
      "main": [
        [
          {
            "node": "Download File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download File": {
      "main": [
        [
          {
            "node": "Extract Text from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Text from File": {
      "main": [
        [
          {
            "node": "Prepare Document Metadata",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Document Metadata": {
      "main": [
        [
          {
            "node": "Qdrant Vector Store - Insert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Token Splitter (~800 tokens)": {
      "ai_textSplitter": [
        [
          {
            "node": "Document Loader",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Document Loader": {
      "ai_document": [
        [
          {
            "node": "Qdrant Vector Store - Insert",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Embeddings (Dense)": {
      "ai_embedding": [
        [
          {
            "node": "Qdrant Vector Store - Insert",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "Qdrant Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Qdrant Vector Store1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Question and Answer Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere": {
      "ai_reranker": [
        [
          {
            "node": "Qdrant Vector Store1",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Embeddings (Query)": {
      "ai_embedding": [
        [
          {
            "node": "Qdrant Vector Store - Retrieve",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Cohere Reranker": {
      "ai_reranker": [
        [
          {
            "node": "Qdrant Vector Store - Retrieve",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Vector Store Retriever": {
      "ai_retriever": [
        [
          {
            "node": "Question and Answer Chain",
            "type": "ai_retriever",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        []
      ]
    },
    "Qdrant Vector Store - Retrieve": {
      "ai_vectorStore": [
        [
          {
            "node": "Vector Store Retriever",
            "type": "ai_vectorStore",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "39416b3e-112f-4391-ae57-7319545d7f99",
  "triggerCount": 0,
  "shared": [
    {
      "createdAt": "2025-10-22T15:50:25.985Z",
      "updatedAt": "2025-10-22T15:50:25.985Z",
      "role": "workflow:owner",
      "workflowId": "cItPt9hr0xCLTDxv",
      "projectId": "Oe16LxplPC150asV"
    }
  ],
  "tags": []
}